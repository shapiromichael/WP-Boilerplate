var sortlist={};jQuery(function(e){window.sortlist={params:{speed:250,autoclose:!0},init:function(){e(".sort-list li .label").live("click",function(){e(this).next(".details").animate({height:850},500)});e(".sort-list ul").sortable({placeholder:"drop-zone",handle:".dragger",items:"li",stop:sortlist.update,opacity:.9,delay:0});e(".sort-list li .label").click(sortlist.toggle);e(".sort-list .add").click(sortlist.add);e(".sort-list li .remove").click(sortlist.remove);e(".sort-list input[type=date]").datepicker({changeMonth:!0,changeYear:!0,showOtherMonths:!0,selectOtherMonths:!0});e(".sortlist-colorpicker").each(function(){var t=e(this),n="FFFFFF";t.attr("color")!=""&&(n=t.attr("color"));t.ColorPicker({color:n,livePreview:!0,onChange:function(e,n,r){t.css("background-color","#"+n);t.find("input").val(n)},onHide:function(t){e(t).fadeOut(500);return!1}})});sortlist.updateAll()},toggle:function(){e(this).parents("li").hasClass("open")?sortlist.close(e(this).parents("li")):sortlist.open(e(this).parents("li"))},open:function(t){sortlist.params.autoclose&&sortlist.close(e(".sort-list li.open"));t.addClass("open");t.find(".details").slideDown(sortlist.params.speed)},close:function(e){e.removeClass("open");e.find(".details").slideUp(sortlist.params.speed)},add:function(){e(this).parents(".sort-list").append('<input type="hidden" name="add-new-sortlist-item" value="'+(e(this).parents(".sort-list li").size()+1)+'"/>');e("form").submit()},remove:function(){e(this).parents("li").css({background:"#FF9999"}).animate({opacity:"1"},sortlist.params.speed*2,function(){var t=e(this).parents(".sort-list").find("input[type=hidden][remove=true]");t.val(e(this).attr("pos"));e(this).remove();sortlist.updateAll();e("form").submit()})},update:function(e){sortlist.updateAll()},updateAll:function(){e(".sort-list").each(function(){var t=e(this).find("input[type=hidden].order-data");t.val("");e(this).find("li").each(function(){t.val()?t.val(t.val()+","+e(this).attr("pos")):t.val(e(this).attr("pos"))})})}};sortlis.init()})(window.jQuery);